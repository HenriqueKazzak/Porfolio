--!TABELA             	COLUNAS
------------------    	-------------------------------------------------------------
FORNECEDOR         	CODIGO_FORNECEDOR, NOME_FORNECEDOR, CIDADE
PEÇA                 	CODIGO_PEÇA, NOME_PEÇA, PRECO
CARRO		  	CODIGO_CARRO, NOME_CARRO, TIPO
FORNECIMENTO 	CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO

Escreva um comando SQL que seja capaz de consultar os fornecedores localizados na cidade de nome “VITORIA” que fornecem a peca de código “MOTOR” para o carro de código “KOMBI”, com os respectivos preços.

--CRIAR TABELA

CREATE TABLE FORNECEDOR (
    CODIGO_FORNECEDOR INTEGER PRIMARY KEY,
    NOME_FORNECEDOR VARCHAR(50),
    CIDADE VARCHAR(50)
);

CREATE TABLE PEÇA (
    CODIGO_PEÇA INTEGER PRIMARY KEY,
    NOME_PEÇA VARCHAR(50),
    PRECO FLOAT
);

CREATE TABLE CARRO (
    CODIGO_CARRO INTEGER PRIMARY KEY,
    NOME_CARRO VARCHAR(50),
    TIPO VARCHAR(50)
);

CREATE TABLE FORNECIMENTO(
    CODIGO_FORNECEDOR INTEGER,
    CODIGO_PECA INTEGER,
    CODIGO_CARRO INTEGER,
    FOREIGN KEY (CODIGO_FORNECEDOR) REFERENCES FORNECEDOR(CODIGO_FORNECEDOR),
    FOREIGN KEY (CODIGO_PECA) REFERENCES PEÇA(CODIGO_PEÇA),
    FOREIGN KEY (CODIGO_CARRO) REFERENCES CARRO(CODIGO_CARRO)
);

--INSERIR DADOS
INSERT INTO FORNECEDOR (CODIGO_FORNECEDOR, NOME_FORNECEDOR, CIDADE) VALUES (1, 'FORNECEDOR 1', 'VITORIA');
INSERT INTO FORNECEDOR (CODIGO_FORNECEDOR, NOME_FORNECEDOR, CIDADE) VALUES (2, 'FORNECEDOR 2', 'VITORIA');
INSERT INTO FORNECEDOR (CODIGO_FORNECEDOR, NOME_FORNECEDOR, CIDADE) VALUES (3, 'FORNECEDOR 3', 'VITORIA');

INSERT INTO PEÇA (CODIGO_PEÇA, NOME_PEÇA, PRECO) VALUES (1, 'MOTOR', 100);
INSERT INTO PEÇA (CODIGO_PEÇA, NOME_PEÇA, PRECO) VALUES (2, 'RODA', 200);
INSERT INTO PEÇA (CODIGO_PEÇA, NOME_PEÇA, PRECO) VALUES (3, 'PNEU', 300);

INSERT INTO CARRO (CODIGO_CARRO, NOME_CARRO, TIPO) VALUES (1, 'KOMBI', 'SUV');
INSERT INTO CARRO (CODIGO_CARRO, NOME_CARRO, TIPO) VALUES (2, 'SEDAN', 'SEDAN');
INSERT INTO CARRO (CODIGO_CARRO, NOME_CARRO, TIPO) VALUES (3, 'HATCH', 'HATCH');

INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (1, 1, 1);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (2, 2, 1);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (3, 3, 1);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (1, 1, 2);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (2, 2, 2);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (3, 3, 2);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (1, 1, 3);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (2, 2, 3);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (3, 3, 3);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (2, 1, 1);
INSERT INTO FORNECIMENTO (CODIGO_FORNECEDOR, CODIGO_PECA, CODIGO_CARRO) VALUES (3, 1, 1);


SELECT FORNECEDOR.NOME_FORNECEDOR, PEÇA.NOME_PEÇA, CARRO.NOME_CARRO, PEÇA.PRECO FROM FORNECEDOR 
JOIN FORNECIMENTO ON FORNECEDOR.CODIGO_FORNECEDOR = FORNECIMENTO.CODIGO_FORNECEDOR 
JOIN PEÇA ON FORNECIMENTO.CODIGO_PECA = PEÇA.CODIGO_PEÇA 
JOIN CARRO ON FORNECIMENTO.CODIGO_CARRO = CARRO.CODIGO_CARRO 
WHERE FORNECEDOR.CIDADE = 'VITORIA' AND PEÇA.NOME_PEÇA = 'MOTOR' AND CARRO.NOME_CARRO = 'KOMBI';

